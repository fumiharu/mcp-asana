---
description: "ローカルの変更を分析してテスト観点を抽出する"
allowed-tools: Bash(git:*)
---

# ローカル変更の分析とテスト観点抽出

このコマンドは指定したベースブランチからの変更（コミット済み + 未コミット）を分析し、line-app-test-specialistサブエージェントが詳細なテスト観点を抽出します。

## 使い方

- `/analyze-local-changes` → mainブランチからの全変更を分析（デフォルト）
- `/analyze-local-changes develop` → developブランチからの全変更を分析
- `/analyze-local-changes HEAD` → 未コミット変更のみを分析

## ステップ1: ベースブランチの決定

引数が指定されている場合は{{arg1}}を、指定されていない場合は`main`をベースブランチとして使用してください。

## ステップ2: 現在のブランチ名を取得

```bash
git branch --show-current
```

## ステップ3: 変更ファイルの確認

変更されたファイルの一覧を取得してください：

```bash
git status --short
```

## ステップ4: 変更差分の取得

ベースブランチからの詳細な差分を取得してください。引数がある場合は{{arg1}}を、ない場合は`main`を使用：

```bash
git diff {{arg1 || "main"}}
```

## ステップ5: 変更統計の取得

変更の規模を確認してください：

```bash
git diff {{arg1 || "main"}} --stat
```

## ステップ6: サブエージェントによる分析

上記で取得した変更情報と差分を元に、line-app-test-specialistサブエージェントを使用して、以下を実行してください：

**line-app-test-specialistサブエージェントへの指示:**

- line-app-test-specialist.mdに記載されていることを行ってください。
- 主な変更内容を3-5行で要約してください。ノンエンジニアにもわかるように。
- 影響範囲を受けるコンポーネント/モジュールも出力する

---

## 必須テスト観点（優先度: 高）

### 機能テスト
- [ ] [具体的なテストケース1]
  - **手順**: [テスト手順]
  - **期待結果**: [期待される結果]
- [ ] [具体的なテストケース2]

### リグレッションテスト
- [ ] [既存機能の確認項目1]
- [ ] [既存機能の確認項目2]

---

## 推奨テスト観点（優先度: 中）

### 非機能テスト
- [ ] [パフォーマンステスト]
- [ ] [セキュリティテスト]

### 統合テスト
- [ ] [統合テストケース]

---

## 任意テスト観点（優先度: 低）
- [ ] [エクストラな確認項目]

---

## 考慮すべきリスクと注意点
- ⚠️ [リスク1]
- ⚠️ [リスク2]

## テスト実施時の推奨環境
- [環境1]（例: 本番に近いステージング環境）
- [環境2]（例: 各種ブラウザでの動作確認）

## 参考情報
- ブランチ: [現在のブランチ名]
- 変更ファイル数: [N個のファイル]
- 追加行数 / 削除行数: [+N / -M]
```

---

**注意事項:**
- テストケースは具体的かつ実行可能な内容にしてください
- コードベース全体を考慮して、見落としがちな影響範囲も分析してください
- セキュリティやパフォーマンスに重大な影響がある場合は明記してください
- 必要に応じて、プロジェクトの既存テストファイルも参照してください
- 変更がない場合（差分が空）の場合は、その旨を通知してください
