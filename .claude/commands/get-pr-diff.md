---
description: "GitHub PRの差分を取得してテスト観点抽出の準備をする"
allowed-tools: Bash(gh:*)
---

# GitHub PR差分取得とテスト観点抽出

このコマンドはGitHub PRの詳細情報と差分を取得し、その後サブエージェントが詳細なテスト観点を抽出します。

## ステップ1: PR情報の取得

まず、以下のコマンドでPRの基本情報を取得してください：

```bash
gh pr view {{arg1}} --json number,title,body,state,author,createdAt,updatedAt,files,additions,deletions,changedFiles
```

## ステップ2: PR差分の取得

次に、詳細な差分を取得してください：

```bash
gh pr diff {{arg1}}
```

## ステップ3: サブエージェントによる分析

上記で取得したPR情報と差分を元に、Planサブエージェントを使用して以下を実行してください：

**Planサブエージェントへの指示:**

あなたは経験豊富なQAエンジニアです。このPRの差分を詳細に分析し、必要なテスト観点を抽出してください。

### 分析項目

1. **コード変更の理解**
   - 変更されたファイルの種類（フロントエンド、バックエンド、設定、テストなど）
   - 追加・変更・削除された機能
   - 影響範囲の評価

2. **テスト観点の抽出**
   以下の観点でテストケースをリスト化してください：

   **機能テスト（優先度: 高）**
   - 新規追加された機能が仕様通りに動作するか
   - 既存機能への影響（リグレッション）
   - 境界値テスト、異常系テスト
   - エラーハンドリング

   **非機能テスト（優先度: 中）**
   - パフォーマンスへの影響
   - セキュリティの考慮点（認証、認可、入力検証など）
   - アクセシビリティ
   - レスポンシブ対応

   **統合テスト（優先度: 中）**
   - 他のコンポーネントとの連携
   - APIの互換性
   - データベースやストレージへの影響
   - 外部サービスとの連携

3. **出力フォーマット**

以下のMarkdown形式で出力してください：

```markdown
# PR テスト観点分析

## PR概要
- **PR番号**: #XXX
- **タイトル**: [タイトル]
- **作成者**: [作成者]
- **状態**: [状態]
- **変更ファイル数**: X件
- **変更行数**: +XXX / -XXX

## 主な変更内容
[変更内容を3-5行で要約]

## 影響範囲
- [影響を受けるコンポーネント/モジュール]

---

## 必須テスト観点（優先度: 高）

### 機能テスト
- [ ] [具体的なテストケース1]
  - **手順**: [テスト手順]
  - **期待結果**: [期待される結果]
- [ ] [具体的なテストケース2]

### リグレッションテスト
- [ ] [既存機能の確認項目1]
- [ ] [既存機能の確認項目2]

---

## 推奨テスト観点（優先度: 中）

### 非機能テスト
- [ ] [パフォーマンステスト]
- [ ] [セキュリティテスト]

### 統合テスト
- [ ] [統合テストケース]

---

## 任意テスト観点（優先度: 低）
- [ ] [エクストラな確認項目]

---

## 考慮すべきリスクと注意点
- ⚠️ [リスク1]
- ⚠️ [リスク2]

## テスト実施時の推奨環境
- [環境1]（例: 本番に近いステージング環境）
- [環境2]（例: 各種ブラウザでの動作確認）

## 参考情報
- PR URL: [URL]
- 関連Issue: [あれば記載]
```

---

**注意事項:**
- テストケースは具体的かつ実行可能な内容にしてください
- コードベース全体を考慮して、見落としがちな影響範囲も分析してください
- セキュリティやパフォーマンスに重大な影響がある場合は明記してください
- 必要に応じて、プロジェクトの既存テストファイルも参照してください
